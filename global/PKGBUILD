# Maintainer: Lucas De Marchi <lucas.de.marchi@gmail.com>
# Contributor: Philipp Robbel <robbel@gmail.com>
# Contributor: John K. Luebs <jkluebs@luebsphoto.com>

pkgname=global
pkgver=5.9.7
pkgrel=1
pkgdesc="A source code tag system"
arch=(i686 x86_64)
url="http://www.gnu.org/software/global/"
license=('GPL')
depends=()
optdepends=('idutils' 'perl>=4')
backup=('etc/gtags.conf')
install=${pkgname}.install
source=(http://tamacom.com/global/$pkgname-$pkgver.tar.gz gtags.conf.patch)

build() {
	cd $startdir/src/$pkgname-$pkgver

	./configure --prefix=/usr
	make || return 1
	make DESTDIR=$startdir/pkg install

	# copy gtags.conf and apply patch
	mkdir -p $startdir/pkg/etc
	cp $startdir/pkg/usr/share/gtags/gtags.conf $startdir/pkg/etc
	patch $startdir/pkg/etc/gtags.conf $startdir/src/gtags.conf.patch

	# symbolic link to gtags.el
	mkdir -p $startdir/pkg/usr/share/emacs/site-lisp
	ln -s /usr/share/gtags/gtags.el $startdir/pkg/usr/share/emacs/site-lisp/gtags.el
}
md5sums=('cd21186c36bc229bd1d9c3cdb51cdcf0'
         '1034584f04eb5b27fa49671d8308c931')
