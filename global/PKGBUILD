# Maintainer: Lucas De Marchi <lucas.de.marchi@gmail.com>
# Contributor: Philipp Robbel <robbel@gmail.com>
# Contributor: John K. Luebs <jkluebs@luebsphoto.com>

pkgname=global
pkgver=6.0
pkgrel=jkl1
pkgdesc="A source code tag system"
arch=(i686 x86_64)
url="http://www.gnu.org/software/global/"
license=('GPL')
depends=()
optdepends=('idutils' 'perl>=4')
backup=('etc/gtags.conf')
install=${pkgname}.install
source=(http://tamacom.com/global/$pkgname-$pkgver.tar.gz gtags.conf.patch)
md5sums=('5a6439f1fee02d8df3b1ed83049c294e'
         '69677bb394af7ef71ff5db7ffd227fa4')

build() {
	cd $startdir/src/$pkgname-$pkgver

	./configure --prefix=/usr
	make || return 1
	make DESTDIR=$startdir/pkg install

	# copy gtags.conf and apply patch
	mkdir -p $startdir/pkg/etc
	cp $startdir/pkg/usr/share/gtags/gtags.conf $startdir/pkg/etc
	patch $startdir/pkg/etc/gtags.conf $startdir/src/gtags.conf.patch

	# symbolic link to gtags.el
	mkdir -p $startdir/pkg/usr/share/emacs/site-lisp
	ln -s /usr/share/gtags/gtags.el $startdir/pkg/usr/share/emacs/site-lisp/gtags.el
}
